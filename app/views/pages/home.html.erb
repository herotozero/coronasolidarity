<div class="landing-banner-one d-flex align-items-center">
  <div style="width: 50vw">
    <h1>Helfen Sie jetzt!</h1>
    <h5 style="padding-bottom: 1vh;">Leisten Sie medizinische oder pflegerische Hilfe als Antwort auf die Corona Pandemie.</h5>
    <div class="d-flex align-items-center">
      <%= link_to "Als Helfer registrieren", new_helper_path, class: 'btn-mint' %>
      <%= link_to "Helfer anfragen", new_hospital_path, class: 'btn-mint' %>
    </div>
  </div>
  <div class="landing-image-box">
    <%= image_tag "landing_image_green.svg", class:"landing_image" %>
  </div>
</div>

<div class="landing-banner-two">

</div>

<div class="landing-banner-three">

</div>

<%-# Alte Landing Page Below -%>

<div class="pricing-header px-3 py-3 pt-md-5 pb-md-4 mx-auto text-center">
  <h1 class="display-4">Helfen Sie jetzt!</h1>
  <p class="lead">Leisten Sie medizinische oder pflegerische Hilfe als Antwort auf die Corona Pandemie.</p>
</div>
<div class="container">
  <div class="card-deck mb-3 text-center">
    <div class="card mb-4 shadow-sm">
      <div class="card-header">
        <h4 class="my-0 font-weight-normal">Helfer:innen</h4>
      </div>
      <div class="card-body">
        <h1 class="card-title pricing-card-title">Helfen</h1>
        <ul class="list-unstyled mt-3 mb-4">
          <li>Medizinstudent:innen ab dem x-ten Semester</li>
          <li>Personen in der Pflege-Ausbildung</li>
          <li>Ärzt:innen & Pflegehelfer:innen</li>
          <li>Andre Menschen mit medizinischer oder pflegerischer Ausbildung</li>
        </ul>
        <%= link_to "Als Helfer:in melden", new_helper_path, class: 'btn-mint' %>
      </div>
    </div>
    <div class="card mb-4 shadow-sm">
      <div class="card-header">
        <h4 class="my-0 font-weight-normal">Krankenhäuser</h4>
      </div>
      <div class="card-body">
        <h1 class="card-title pricing-card-title">Helfen lassen</h1>
        <ul class="list-unstyled mt-3 mb-4">
          <li>Konkrete Bedarfe anmelden</li>
          <li>Kontaktstelle benennen</li>
          <li>Alle gemeldeten Herfer:innen im Einzugsbereich werden informiert</li>
          <li>-</li>
        </ul>
        <%= link_to "Als Krankenhaus melden", '', class: 'btn-mint', style: 'color:#fff' %>
      </div>
    </div>
  </div>
</div>
<div class="container">
  <div class="row mb-2">
    <div class="col-md-6">
      <div class="card flex-md-row mb-4 box-shadow h-md-250">
        <div class="card-body d-flex flex-column align-items-start">
          <strong class="d-inline-block mb-2 text-primary">Mitmachen!</strong>
          <h3 class="mb-0">
            <p class="text-dark">Was macht Corona Solidarity?</p>
          </h3>
          <p class="card-text mb-2">Deutschland und nahezu die gesamte Welt steht gerade vor einer großen Herausforderung - der Eindämmung und Bekämpfung der rasanten Ausbreitung von COVID-19.</p>
          <p class="card-text mb-2">Um die Krankenhäuser und andere medizinische Einrichtungen zu entlasten, wurde mit Corona Solidarity im Rahmen des Hackathons der Deutschen Bundesregierung eine zentrale <strong>Vermittlungsplattform für Krankenhäuser und Helfer:innen</strong> aus medizinischen Berufen / Ausbildungen geschaffen.</p>
          <p class="card-text mb-2">Über die Plattform können Kapazitäten sowie Skill-Level des medizinischen/ pflegerischen Hilfspersonal zentral erfasst und mit den Bedarfen der Krankenhäuser abgeglichen werden. Corona Solidarity vermittelt im Anschluss den Kontakt zwischen beiden Parteien.</p>
        </div>

      </div>
    </div>
    <div class="col-md-6">
      <div class="card flex-md-row mb-4 box-shadow h-md-250">
        <div class="card-body d-flex flex-column align-items-start">
          <div id="map" class="map" style="height: 600px; width: 100%"></div>
        </div>
      </div>
    </div>
  </div>
</div>
<script type="text/javascript">
    let mymap = L.map('map').setView([51.133481, 10.018343], 6);

    L.tileLayer('https://api.mapbox.com/styles/v1/{id}/tiles/{z}/{x}/{y}?access_token={accessToken}', {
        attribution: 'Map data &copy; <a href="https://www.openstreetmap.org/">OpenStreetMap</a> contributors, <a href="https://creativecommons.org/licenses/by-sa/2.0/">CC-BY-SA</a>, Imagery © <a href="https://www.mapbox.com/">Mapbox</a>',
        maxZoom: 18,
        id: 'mapbox/streets-v11',
        tileSize: 512,
        zoomOffset: -1,
        accessToken: 'pk.eyJ1IjoiaGVyYmVydHRvdCIsImEiOiJjazgxc3U4bjIwaXpkM25tczEyc2JxYXNjIn0.NkeHkNFThuchdMw4dElBrw'
    }).addTo(mymap);

    async function getLonLatFromCity(city) {
        let reponse  = await fetch(`https://api.mapbox.com/geocoding/v5/mapbox.places/${city}.json?access_token=pk.eyJ1IjoiaGVyYmVydHRvdCIsImEiOiJjazgxc3U4bjIwaXpkM25tczEyc2JxYXNjIn0.NkeHkNFThuchdMw4dElBrw`);
        return await reponse.json();
    }

    async function setMarkers(cities, numbers) {
        console.log(cities);
        console.log(numbers);
        let markers = L.markerClusterGroup();


        cities.forEach(function(city){
            getLonLatFromCity(city)
                .then(data =>  markers.addLayer(new L.Marker([data['features'][0]['center'][1], data['features'][0]['center'][0]], {
                icon:	new L.AwesomeNumberMarkers({
                    number: numbers[city],
                    markerColor: "blue"
                })
            }).bindPopup(`<div style="text-align: center"><b>${city}</b><\div><br>Es ist/sind <strong>${numbers[city]}</strong> Personen registriert`)
                ))
        });
        mymap.addLayer(markers);
    }




</script>
<%= javascript_tag "setMarkers(#{@cities.to_json.html_safe}, #{@numbers.to_json.html_safe});" %>
